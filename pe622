input=:60
div=:/:~ @:,@:>@:(*/&.>/)@:((^i.@>:)&.>/)@:(__&q:)
candidates=:div<:2^x:input
f=:3 : '#(y&|@:*&2)^:(1&~:)^:a: 2'
+/1+candidates{~I.input=f"0 candidates
